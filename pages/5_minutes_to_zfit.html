
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5 minutes to zfit &#8212; zfit</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/zfit-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction to zfit" href="../zfit-tutorials_copy/introduction/Introduction.html" />
    <link rel="prev" title="zfit: scalable, pythonic fitting" href="../index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      <h1 class="site-logo" id="site-title">zfit</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5 minutes to zfit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../zfit-tutorials_copy/introduction/Introduction.html">
   Introduction to zfit
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../zfit-tutorials_copy/TensorFlow/HPC_with_TensorFlow.html">
   HPC in Python with TensorFlow
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../zfit-tutorials_copy/components/20%20-%20Composite%20Models.html">
   Composite Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../zfit-tutorials_copy/components/60%20-%20Custom%20PDF.html">
   Creating your own pdf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../zfit-tutorials_copy/guides/custom_models.html">
   Custom models
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/pages/5_minutes_to_zfit.rst"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/zfit/poster"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/zfit/poster/issues/new?title=Issue%20on%20page%20%2Fpages/5_minutes_to_zfit.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/zfit/poster/edit/master/website/pages/5_minutes_to_zfit.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="minutes-to-zfit">
<span id="id1"></span><h1>5 minutes to zfit<a class="headerlink" href="#minutes-to-zfit" title="Permalink to this headline">¶</a></h1>
<p>The zfit library provides a simple model fitting and sampling framework for a broad list of applications.
This section is designed to give an overview of the main concepts and features in the context of likelihood fits in
a <em>crash course</em> manner. The simplest example is to generate, fit and plot a Gaussian distribution.</p>
<p>The first step is to import <code class="docutils literal notranslate"><span class="pre">zfit</span></code> and to verify that the installation has been done successfully:</p>
<button title="Run this interactively" class="thebelab-button thebe-launch-button"onclick="initThebe()">Run this interactively</button><p>Since we want to generate/fit a Gaussian within a given range, the domain of the PDF is defined by
an <em>observable space</em>. This can be created using the <code class="xref py py-class docutils literal notranslate"><span class="pre">Space</span></code> class</p>
<p>The best interpretation of the observable at this stage is that it defines the name and range of the observable axis.</p>
<p>Using this domain, we can now create a simple Gaussian PDF.
The most common PDFs are already pre-defined within the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pdf</span></code> module, including a simple Gaussian.
First, we have to define the parameters of the PDF and their limits using the <code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code> class:</p>
<p>With these parameters we can instantiate the Gaussian PDF from the library</p>
<p>It is recommended to pass the arguments of the PDF as keyword arguments.</p>
<p>The next stage is to create a dataset to be fitted. There are several ways of producing this within the
zfit framework (see the <span class="xref std std-ref">Data</span> section). In this case, for simplicity we simply produce
it using numpy and the <code class="xref py py-func docutils literal notranslate"><span class="pre">Data.from_numpy</span></code> method:</p>
<p>Now we have all the ingredients in order to perform a maximum likelihood fit.
Conceptually this corresponds to three basic steps:</p>
<ol class="arabic simple">
<li><p>create a loss function, in our case a negative log-likelihood <span class="math notranslate nohighlight">\(\log\mathcal{L}\)</span>;</p></li>
<li><p>instantiate our choice of minimiser;</p></li>
<li><p>and minimise the log-likelihood.</p></li>
</ol>
<p>This corresponds to the most basic example where the negative likelihood is defined within the pre-determined
observable range and all the parameters in the PDF are floated in the fit. It is often the case that we want to
only vary a given set of parameters. In this case it is necessary to specify which are the parameters to be floated
(so all the remaining ones are fixed to their initial values).</p>
<p>Also note that we can now do various things with the pdf such as plotting the fitting result
with the model gaussian without extracting the loss
minimizing parameters from <code class="docutils literal notranslate"><span class="pre">result</span></code>. This is possible because parameters are mutable. This means that the
minimizer can directly manipulate the value of the floating parameter. So when you call the <code class="docutils literal notranslate"><span class="pre">minimizer.minimize()</span></code>
method the value of <code class="docutils literal notranslate"><span class="pre">mu</span></code> changes during the optimisation. <code class="docutils literal notranslate"><span class="pre">gauss.pdf()</span></code> then uses this new value to calculate the
pdf.</p>
<p>It is important to highlight that conceptually zfit separates the minimisation of the loss function with respect to the error calculation,
in order to give the freedom of calculating this error whenever needed and to allow the use of external error calculation packages.</p>
<p>In order to get an estimate for the errors, it is possible to call <code class="docutils literal notranslate"><span class="pre">Hesse</span></code> that will calculate
the parameter uncertainties. This uses the inverse Hessian to approximate the minimum of the loss and returns a symmetric estimate.
When using weighted datasets, this will automatically perform the asymptotic correction to the fit covariance matrix,
returning corrected parameter uncertainties to the user. The correction applied is based on Equation 18 in <a class="reference external" href="https://arxiv.org/abs/1911.01303">this paper</a>.</p>
<p>To call <code class="docutils literal notranslate"><span class="pre">Hesse</span></code>, do:</p>
<p>which will return a dictionary of the fit parameters as keys with <code class="docutils literal notranslate"><span class="pre">error</span></code> values for each one.
The errors will also be added to the result object and show up when printing the result.</p>
<p>While the hessian approximation has many advantages, it may not hold well for certain loss functions, especially for
asymetric uncertainties. It is also possible to use a more CPU-intensive error calculating with the <code class="docutils literal notranslate"><span class="pre">errors</span></code> method.
This has the advantage of taking into account all the correlations and can describe well a
a loss minimum that is not well approximated by a quadratic function <em>(it is however not valid in the case of weights and takes
considerably longer).</em> It estimates the lower and upper uncertainty independently.
As an example, with the <code class="xref py py-class docutils literal notranslate"><span class="pre">Minuit</span></code> one can calculate the <code class="docutils literal notranslate"><span class="pre">MINOS</span></code> uncertainties with:</p>
<p>Once we’ve performed the fit and obtained the corresponding uncertainties,
it is now important to examine the fit results.
The object <code class="docutils literal notranslate"><span class="pre">result</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FitResult</span></code>) has all the relevant information we need:</p>
<p>This is all available if we print the fitresult (not shown here as display problems).</p>
<p>Similarly one can obtain only the information on the fitted parameters with</p>
<p>As already mentioned, there is no dedicated plotting feature within zfit. However, we can easily use external
libraries, such as <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <a class="reference external" href="https://github.com/scikit-hep/mplhep">mplhep, a library for HEP-like plots</a> ,
to do the job:</p>
<p>The specific call to <code class="xref py py-func docutils literal notranslate"><span class="pre">zfit.run()</span></code> simply converts the Eager Tensor (that is already array-like) to a Numpy array.
Often, this conversion is however not necessary and a Tensor can directly be used.</p>
<p>The full script <a href="#id2"><span class="problematic" id="id3">:jupyter-download:script:`can be downloaded here &lt;5 minutes to zfit&gt;`</span></a>.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "zfit/poster",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../index.html" title="previous page">zfit: scalable, pythonic fitting</a>
    <a class='right-next' id="next-link" href="../zfit-tutorials_copy/introduction/Introduction.html" title="next page">Introduction to zfit</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By zfit<br/>
        
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>